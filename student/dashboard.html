<!doctype html>
<html lang="th">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Dashboard ‡∏ô‡∏±‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ô | NexAttend</title>

  <!-- Fonts -->
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link href="https://fonts.googleapis.com/css2?family=Kanit:wght@300;400;500;600;700;800&family=Inter:wght@300;400;600;700;800;900&display=swap" rel="stylesheet" />

  <link rel="stylesheet" href="../css/styles.css" />
  <script src="https://cdn.jsdelivr.net/npm/chart.js" defer></script>
  <script type="module" src="dashboard.js" defer></script>

  <style>
    :root{
      --bg:#f8fafc;
      --card: rgba(255,255,255,.72);
      --card2: rgba(255,255,255,.96);
      --text:#0f172a;
      --muted:#64748b;
      --border: rgba(226,232,240,.95);

      --blue:#38bdf8;
      --violet:#8b5cf6;
      --shadow: 0 18px 55px rgba(2,6,23,.10);
      --r: 22px;
    }

    *{ box-sizing:border-box; }
    html,body{ height:100%; }

    body{
      margin:0;
      /* ‚úÖ ‡∏ö‡∏±‡∏á‡∏Ñ‡∏±‡∏ö‡πÉ‡∏´‡πâ ‚Äú‡∏°‡∏µ‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏•‡∏∑‡πà‡∏≠‡∏ô‚Äù */
      min-height: 120vh;

      font-family:"Kanit","Inter",system-ui,-apple-system,Segoe UI,Roboto,sans-serif;
      color:var(--text);
      background:
        radial-gradient(900px 560px at 12% 14%, rgba(56,189,248,.16), transparent 62%),
        radial-gradient(900px 560px at 88% 16%, rgba(139,92,246,.14), transparent 62%),
        radial-gradient(900px 560px at 50% 92%, rgba(34,197,94,.10), transparent 62%),
        linear-gradient(180deg,#fff,var(--bg));
    }

    /* ===== Scrollbar (‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏ô‡πâ‡∏≤) ===== */
    html{
      overflow-y: scroll;
      scrollbar-gutter: stable;
    }
    ::-webkit-scrollbar{ width: 14px; }
    ::-webkit-scrollbar-track{
      background: rgba(2,6,23,.06);
      border-left: 1px solid rgba(226,232,240,.9);
    }
    ::-webkit-scrollbar-thumb{
      background: linear-gradient(180deg, rgba(56,189,248,.90), rgba(139,92,246,.80));
      border-radius: 999px;
      border: 3px solid rgba(255,255,255,.90);
    }
    ::-webkit-scrollbar-thumb:hover{
      background: linear-gradient(180deg, rgba(56,189,248,1), rgba(139,92,246,.95));
    }
    *{ scrollbar-width: auto; scrollbar-color: rgba(139,92,246,.80) rgba(2,6,23,.06); }

    /* ===== Topbar: ‡πÅ‡∏≠‡∏î‡∏°‡∏¥‡∏ô‡πÄ‡∏õ‡πä‡∏∞ (‡πÄ‡∏ï‡πá‡∏°‡∏à‡∏≠ + ‡∏ï‡∏¥‡∏î‡∏ö‡∏ô) ===== */
    .topbar{
      position: sticky;
      top: 0;
      z-index: 9999;
      width:100%;
      border-bottom: 1px solid var(--border);
      background: rgba(255,255,255,.72);
      backdrop-filter: blur(12px);
    }
    .topbar-inner{
      max-width:1100px;
      margin:0 auto;
      padding: 12px 18px;
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap: 12px;
    }

    .brand{ display:flex; gap:12px; align-items:center; min-width:0; }
    .avatar{
      width:42px;height:42px;border-radius:16px;
      background: linear-gradient(135deg, var(--blue), var(--violet));
      box-shadow: 0 14px 34px rgba(2,6,23,.10);
      flex:0 0 auto;
    }
    #studentName{
      font-size:1.02rem;
      font-weight:1000;
      white-space:nowrap;
      overflow:hidden;
      text-overflow:ellipsis;
      max-width: 420px;
      letter-spacing:-.2px;
      line-height:1.1;
    }
    .pid{ margin-top:6px; display:flex; gap:8px; align-items:center; flex-wrap:wrap; }
    .tag{
      padding:4px 10px;
      border-radius:999px;
      border:1px solid var(--border);
      background: rgba(2,6,23,.03);
      color: rgba(15,23,42,.82);
      font-size:.8rem;
      font-weight:1000;
      box-shadow: 0 10px 22px rgba(2,6,23,.05);
    }

    .actions{ display:flex; gap:10px; flex-wrap:wrap; justify-content:flex-end; align-items:center; }

    .btn{
      border:none;
      cursor:pointer;
      padding:10px 14px;
      border-radius:999px;
      font-weight:1000;
      color:#04121f;
      background: linear-gradient(90deg, var(--blue), #60a5fa);
      box-shadow: 0 18px 45px rgba(56,189,248,.20);
      display:inline-flex;
      align-items:center;
      gap:8px;
      text-decoration:none;
      user-select:none;
      white-space:nowrap;
      transition:.18s;
    }
    .btn:hover{ transform: translateY(-1px); box-shadow: 0 26px 70px rgba(56,189,248,.24); }
    .btn.secondary{
      background: rgba(2,6,23,.03);
      border:1px solid var(--border);
      box-shadow: 0 10px 25px rgba(2,6,23,.06);
      color: var(--text);
    }
    .btn.secondary:hover{ border-color: rgba(148,163,184,.70); box-shadow: 0 18px 45px rgba(2,6,23,.10); transform: translateY(-1px); }
    .btn.danger{
      background: linear-gradient(135deg, rgba(239,68,68,.95), rgba(245,158,11,.95));
      color:#fff;
      box-shadow: 0 18px 45px rgba(239,68,68,.20);
    }

    /* ===== Content ===== */
    .wrap{
      max-width:1100px;
      margin:0 auto;
      padding: 18px 18px 120px; /* ‚úÖ ‡∏Å‡∏±‡∏ô‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà‡∏•‡πà‡∏≤‡∏á‡πÄ‡∏û‡∏¥‡πà‡∏° ‡πÉ‡∏´‡πâ‡πÄ‡∏Å‡∏¥‡∏î scroll ‡πÅ‡∏ô‡πà */
    }

    .grid{
      margin-top: 16px;
      display:grid;
      grid-template-columns: repeat(12, 1fr);
      gap: 14px;
    }

    .card{
      border-radius: var(--r);
      background: var(--card);
      border: 1px solid var(--border);
      box-shadow: var(--shadow);
      backdrop-filter: blur(10px);
      overflow:hidden;
      padding:16px;
    }

    .stat{ grid-column: span 3; min-height:96px; display:flex; flex-direction:column; justify-content:center; gap:6px; }
    .stat .label{ font-size:.92rem; color:var(--muted); font-weight:1000; }
    .stat .val{ font-size:2.15rem; font-weight:1000; line-height:1.05; }

    .left{ grid-column: span 7; min-height:380px; background: var(--card2); }
    .right{ grid-column: span 5; min-height:380px; background: var(--card2); display:flex; flex-direction:column; gap:12px; }

    h3{ margin:0 0 10px 0; font-size:1.05rem; font-weight:1000; letter-spacing:-.2px; }

    table{
      width:100%;
      border-collapse: collapse;
      overflow:hidden;
      border-radius: 16px;
      border:1px solid rgba(226,232,240,.95);
      background: rgba(255,255,255,.96);
      box-shadow: 0 12px 30px rgba(2,6,23,.06);
    }
    thead th{
      text-align:left;
      font-size:.82rem;
      color: rgba(100,116,139,.95);
      padding:12px 12px;
      background: rgba(2,6,23,.02);
      border-bottom:1px solid rgba(226,232,240,.95);
      font-weight:1000;
      letter-spacing:.8px;
    }
    tbody td{
      padding:12px 12px;
      border-bottom:1px solid rgba(226,232,240,.75);
      font-size:.92rem;
      color:var(--text);
      font-weight:800;
    }
    tbody tr:hover td{ background: rgba(56,189,248,.06); }
    tbody tr:last-child td{ border-bottom:none; }
    .empty{ text-align:center; color:var(--muted); padding:18px 12px; font-weight:1000; }

    .chartWrap{
      flex:1;
      min-height:260px;
      padding:14px;
      border-radius:16px;
      border:1px solid rgba(226,232,240,.95);
      background: rgba(255,255,255,.96);
      box-shadow: 0 12px 30px rgba(2,6,23,.06);
    }

    #msg{ margin-top:12px; color: var(--muted); font-size:.95rem; min-height:18px; font-weight:900; }

    @media (max-width: 980px){
      .stat{ grid-column: span 6; }
      .left{ grid-column: span 12; }
      .right{ grid-column: span 12; }
      #studentName{ max-width:300px; }
    }
    @media (max-width: 520px){
      .stat{ grid-column: span 12; }
      .topbar-inner{ padding: 10px 14px; }
      .wrap{ padding: 14px 14px 120px; }
      #studentName{ max-width:220px; }
    }
  </style>
</head>

<body>
  <header class="topbar">
    <div class="topbar-inner">
      <div class="brand">
        <div class="avatar"></div>
        <div>
          <div id="studentName">-</div>
          <div class="pid">
            <span id="studentId" class="tag">üÜî -</span>
          </div>
        </div>
      </div>

      <div class="actions">
        <a class="btn secondary" href="scan.html">üì∑ ‡∏´‡∏ô‡πâ‡∏≤‡∏™‡πÅ‡∏Å‡∏ô</a>
        <a class="btn secondary" href="history.html">üóÇÔ∏è ‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥</a>
        <button id="refreshBtn" class="btn secondary" type="button">üîÑ ‡∏£‡∏µ‡πÄ‡∏ü‡∏£‡∏ä</button>
        <button id="logoutBtn" class="btn danger" type="button">‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡∏£‡∏∞‡∏ö‡∏ö</button>
      </div>
    </div>
  </header>

  <main class="wrap">
    <div class="grid">
      <div class="card stat"><div class="label">‡∏Ñ‡∏≤‡∏ö‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</div><div id="totalSessions" class="val">0</div></div>
      <div class="card stat"><div class="label">‡∏°‡∏≤‡πÄ‡∏£‡∏µ‡∏¢‡∏ô</div><div id="attendedCount" class="val">0</div></div>
      <div class="card stat"><div class="label">‡∏™‡∏≤‡∏¢</div><div id="lateCount" class="val">0</div></div>
      <div class="card stat"><div class="label">‡∏Ç‡∏≤‡∏î</div><div id="absentCount" class="val">0</div></div>

      <section class="card left">
        <h3>‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î</h3>
        <table>
          <thead>
            <tr><th style="width:40%;">‡πÄ‡∏ß‡∏•‡∏≤</th><th>‡∏ß‡∏¥‡∏ä‡∏≤</th><th style="width:20%;">‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞</th></tr>
          </thead>
          <tbody id="recentAttendance">
            <tr><td colspan="3" class="empty">‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥</td></tr>
          </tbody>
        </table>
        <div id="msg"></div>
      </section>

      <section class="card right">
        <h3>‡∏™‡∏£‡∏∏‡∏õ‡∏†‡∏≤‡∏û‡∏£‡∏ß‡∏°</h3>
        <div class="chartWrap"><canvas id="attendanceChart"></canvas></div>
      </section>
    </div>
  </main>
</body>
</html>
